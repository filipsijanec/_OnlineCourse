(()=>{"use strict";const t=window.wp.url,e=WCBT_GLOBAL_OBJECT.is_multisite||!1,o=WCBT_GLOBAL_OBJECT.blog_id||"",n=(t,n,i=0,c=0)=>{const r=new Date;r.setTime(r.getTime()+24*i*60*60*1e3+60*c*60*1e3);const s="expires="+r.toUTCString();e&&(t=`${t}_${o}`),document.cookie=`${t}=${n};${s};path=/`};document.querySelector("#wcbt-snackbar"),WCBT_GLOBAL_OBJECT.rest_namespace,WCBT_GLOBAL_OBJECT.user_id;const{__}=wp.i18n,i=(WCBT_WISHLIST_OBJECT.add_wishlist_tooltip_text,WCBT_WISHLIST_OBJECT.remove_wishlist_tooltip_text,()=>{const t=(t=>{e&&(t=`${t}_${o}`),t+="=";const n=decodeURIComponent(document.cookie).split(";");for(let e=0;e<n.length;e++){let o=n[e];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""})("wcbt_wishlist_product");return null!==t&&t?t.split(",").map(Number):[]}),c=t=>{[...document.querySelectorAll(".wcbt-show-wishlist .count")].map((e=>{e.innerHTML=t}))},r=document.querySelector("#wcbt-wishlist"),s=(r.querySelector(".wcbt-wishlist-title"),r.querySelector(".wcbt-product-container")),a=document.querySelector("#wcbt-snackbar"),{__:l}=wp.i18n;let d;const u=WCBT_GLOBAL_OBJECT.rest_namespace||"",p={orderby:"name",order:"asc"};let _={};const h=WCBT_GLOBAL_OBJECT.user_id||"",m=(e={},o=!1)=>{!1===o&&(s.style.opacity=.4);const n={...p,...e};wp.apiFetch({path:(0,t.addQueryArgs)("/"+u+"/wishlist",n),method:"GET"}).then((t=>{void 0!==t.data.content?o?s.insertAdjacentHTML("beforeend",t.data.content):s.innerHTML=t.data.content:t.msg&&!1===o&&(s.innerHTML=`<p>${t.msg}</p>`),w(t)})).catch((t=>{console.log(t)})).finally((()=>{const e=_;h||delete e.post_in;const o=(n=e,(0,t.addQueryArgs)(document.location.origin+document.location.pathname,n));var n;window.history.pushState("","",o),s.style.opacity=1}))},w=t=>{void 0!==t.data.pagination?r.querySelector(".wcbt-pagination").innerHTML=t.data.pagination:r.querySelector(".wcbt-pagination").innerHTML="",void 0!==t.data.from_to?r.querySelector(".wcbt-from-to").innerHTML=t.data.from_to:r.querySelector(".wcbt-from-to").innerHTML="";const e=r.querySelector(".wcbt-pagination");if(e){const t=e.querySelectorAll("a");for(let e=0;e<t.length;e++)t[e].addEventListener("click",(function(t){t.preventDefault();const e=this.getAttribute("data-page");_={..._,page:e},h||(_={..._,post_in:i()}),m(_),r.scrollIntoView({behavior:"smooth"})}))}},T=()=>{a.classList.add("active"),d&&clearTimeout(d),d=setTimeout((()=>{a.classList.remove("active"),a.innerHTML=""}),"3000")},L=()=>{if(!s)return;const t=(()=>{const t=new URLSearchParams(location.search),e={};for(const[o,n]of t)e[o]=n;return e})();if(Object.keys(t).length&&(_={..._,...t}),!h){const t=i();_={..._,post_in:t}}m(_),document.addEventListener("click",(function(t){const e=s.querySelectorAll("tr .product-remove");if(e)for(let o=0;o<e.length;o++){const r=e[o];if(r.contains(t.target)){t.preventDefault();let e=r.closest("tr").getAttribute("data-product-id");if(e=parseInt(e),r.disabled=!0,h){const t={product_id:e};wp.apiFetch({path:"/"+u+"/wishlist",method:"POST",data:t}).then((t=>{t.status,a.innerHTML=l("Product WishList removed","wcbt"),T(),c(t.data.total),m({page:1})})).catch((t=>{console.log(t)})).finally((()=>{r.disabled=!1}))}else{let t=i();t&&t.includes(e)&&(t=t.filter((t=>t!==e)),a.innerHTML=l("Product WishList removed","wcbt")),n("wcbt_wishlist_product",t.join(","),30),T(),c(t.length),m({post_in:t})}}}}))};document.addEventListener("DOMContentLoaded",(t=>{L()}))})();